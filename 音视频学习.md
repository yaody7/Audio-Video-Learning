# 音视频学习

```
通过阅读《音视频开发进阶指南》，学习音视频的基础知识。
```

## 1.2 数字音频

1. 采样率需要为最高频率2倍以上

2. 音频的裸数据格式是脉冲调制数据（Pulse Code Modulation PCM），必须有的字段

   - 量化格式（sampleFormat），几个比特来衡量一个声音的高低
   - 采样率（sampleRate）
   - 声道数（channel）

   例子：CD，量化格式16bit，采样率44100，声道数2 ----> 比特率 44100 * 2 * 16 = 1378.125kbps

3. 麦克风采集声音：麦克风里的碳膜因为被声音挤压发生震动，碳膜下是电极，接收震动，通过放大电路，记录下来。

## 1.3 音频编码

1. 压缩编码算法：PCM、WAV、AAC、MP3、Ogg等

2. 压缩编码原理是：压缩掉冗余信号，如：

   - 人耳感知不到的信号
   - 被掩蔽掉的音频信号：频域掩蔽、时域掩蔽

3. WAV编码

   - PCM数据格式后加入44字节，保存PCM采样率、声道数、数据格式等信息。

   - 音质非常好，大量软件支持

4. MP3编码

   - 压缩比高，大量软件支持，高于128Kbit/s比特率的场景下表现较好

5. AAC编码
   - 低于128Kbit/s比特率的场景下表现较好，中音频轨编码
6. Ogg编码
   - 兼容较差，高中低码率都还可以

## 1.5 图像的数值表示

1. 1280 * 720 的RGBA_8888大小

   1280 * 720 * 4 = 3.516MB

2. YUV数据格式

   - Y为明 **亮度** Luma，通过RGB特定部分叠加到一起建立。

   - U和V表示 **色度** Chroma，建立色彩和饱和度

     1. Cb反应RGB蓝色部分和亮度值的差异

     2. Cr反映RGB红色部分和亮度值的差异

3. 使用YUV是因为Y亮度和UV分离，适配黑白电视

4. 广播电视不传输很低和很高的数值，避免信号变动造成过载 

   - Y：16～235
   - UV：16～240

5. YUV最常使用的是4:2:0，指的是一列4:2:0，一列4:0:2

   ![Screen Shot 2021-04-27 at 5.32.59 PM](/Users/bytedance/Library/Application Support/typora-user-images/Screen Shot 2021-04-27 at 5.32.59 PM.png)

![Screen Shot 2021-04-27 at 5.46.02 PM](/Users/bytedance/Library/Application Support/typora-user-images/Screen Shot 2021-04-27 at 5.46.02 PM.png)

6. 1280 * 720 的YUV420大小

   1280 * 720 + 1280 * 720 * 0.5 = 1.318MB

## 1.6 视频编码

1. 视频具有极强的相关性，利用空间、时间上的冗余信息进行压缩。
   - 时间上的冗余信息：帧间编码
     1. 运动补偿：通过先前局部图像预测、补偿当前局部图像
     2. 运动表示：不同区域图像需要使用运动矢量来描述运动信息
     3. 运动估计：从视频序列中抽取运动信息的一整套技术
   - 空间上的冗余信息：帧内编码
2. MPEG适用于动态视频的压缩算法，
   - 单幅图像编码
   - 利用图像序列原则去除冗余

3. Mpeg1（用于VCD）、Mpeg2（用于DVD）、Mpeg4（用于AVC流媒体）

   H261、262、263、264是编码标准。

4. I、P、B帧

   - I帧：帧内编码，是每个GOP第一帧，I帧通过压缩，获得了6:1的压缩比，去掉了空间冗余信息
   - P帧：前向预测编码帧，通过对前面已编码帧的时间冗余信息的去除进行压缩
   - B帧：双向预测内插编码帧，前后都看。

5. IDR帧

   特殊的I帧，H264中有可能参考I帧之前的帧，但是不会越过IDR帧，收到这个帧就可以清理参考帧缓冲区

6. PTS 和 DTS

   - DTS是Decoding Time Stamp
   - PTS是Presentation Time Stamp

   如果没有B帧，那么PTS和DTS相同，因为有了B帧，所以输入顺序和编码顺序很可能不同。所以需要两个时间戳

![Screen Shot 2021-04-27 at 6.33.22 PM](/Users/bytedance/Library/Application Support/typora-user-images/Screen Shot 2021-04-27 at 6.33.22 PM.png)

7. 提高质量可以多用B帧，这样可以更多储存I帧。
   - I帧的压缩率是7
   - P帧的压缩率是20
   - B帧的压缩率是50



## 2.3 交叉编译的原理与实践

1. LAME

   MP3编码引擎

2. FDK_ACC

   编码和解码ACC格式音频文件的开源库

3. X264

   MPEG4 H264视频编码函数库





